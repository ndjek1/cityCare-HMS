<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="jakarta.faces.html"
                xmlns:f="jakarta.faces.core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="jakarta.faces.facelets">


    <p:card header="Register New Staff Member" styleClass="reg-card shadow-2">
        <h:form id="staffRegForm" styleClass="p-fluid">

            <!-- Global Growl -->
            <p:messages id="regMessages" showDetail="true" closable="true" autoUpdate="true" />

            <!-- ================== Account Credentials ================== -->
            <p:fieldset legend="Account Credentials" toggleable="false" styleClass="mb-4">
                <div class="grid formgrid">
                    <div class="field col-12 md:col-6 lg:col-4">
                        <p:outputLabel for="username" value="Username:" />
                        <p:inputText id="username" value="#{staffBean.username}" required="true"
                                     requiredMessage="Username is required." />
                    </div>

                    <div class="field col-12 md:col-6 lg:col-4">
                        <p:outputLabel for="password" value="Password:" />
                        <p:password id="password" value="#{staffBean.password}" required="true"
                                    feedback="true" weakLabel="Weak" goodLabel="Good" strongLabel="Strong"
                                    requiredMessage="Password is required." />
                    </div>
                </div>
            </p:fieldset>

            <!-- ================== Personal Information ================== -->
            <p:fieldset legend="Personal Information" toggleable="false" styleClass="mb-4">
                <div class="grid formgrid">
                    <div class="field col-12 md:col-6 lg:col-4">
                        <p:outputLabel for="fullName" value="Full Name:" />
                        <p:inputText id="fullName" value="#{staffBean.fullName}" required="true"
                                     requiredMessage="Full name is required." />
                    </div>

                    <div class="field col-12 md:col-6 lg:col-4">
                        <p:outputLabel for="email" value="Email:" />
                        <p:inputText id="email" value="#{staffBean.email}" type="email" required="true"
                                     requiredMessage="Email is required." validatorMessage="Invalid email format.">
                            <f:validateBean />
                        </p:inputText>
                        <p:message for="email" />
                    </div>

                    <div class="field col-12 md:col-6 lg:col-4">
                        <p:outputLabel for="phone" value="Phone:" />
                        <p:inputMask id="phone" value="#{staffBean.phone}" mask="999 999 9999" >
                            <f:validator validatorId="custom.ugandanPhoneValidator" />
                        </p:inputMask>
                    </div>

                    <div class="field col-12 md:col-6 lg:col-4">
                        <p:outputLabel for="address" value="Address:" />
                        <p:inputTextarea id="address" value="#{staffBean.address}" rows="3" autoResize="false" />
                    </div>

                    <div class="field col-12 md:col-6 lg:col-4">
                        <p:outputLabel for="dob" value="Date of Birth:" />
                        <p:datePicker id="dob" value="#{staffBean.birthday}" showIcon="true" pattern="MM/dd/yyyy" yearRange="c-100:c" />
                    </div>

                    <div class="field col-12 md:col-6 lg:col-4">
                        <p:outputLabel for="gender" value="Gender:" />
                        <p:selectOneRadio id="gender" value="#{staffBean.gender}" layout="responsive" columns="3">
                            <f:selectItem itemLabel="Male" itemValue="Male" />
                            <f:selectItem itemLabel="Female" itemValue="Female" />
                            <f:selectItem itemLabel="Other" itemValue="Other" />
                        </p:selectOneRadio>
                    </div>
                </div>
            </p:fieldset>

            <!-- ================== Professional Details ================== -->
            <p:fieldset legend="Professional Details" toggleable="false" styleClass="mb-4">
                <div class="grid formgrid">
                    <div class="field col-12 md:col-6 lg:col-4">
                        <p:outputLabel for="role" value="Role:" />
                        <p:selectOneMenu id="role" value="#{staffBean.role}" required="true" requiredMessage="Role is required.">
                            <f:selectItem itemLabel="--- Select Role ---" itemValue="#{null}" noSelectionOption="true" />
                            <f:selectItems value="#{staffBean.availableRoles}" var="roleItem"
                                           itemLabel="#{roleItem}" itemValue="#{roleItem}" />
                        </p:selectOneMenu>
                    </div>

                    <div class="field col-12 md:col-6 lg:col-4">
                        <p:outputLabel for="department" value="Department:" />
                        <p:selectOneMenu id="department" value="#{staffBean.department}" required="true" requiredMessage="Department is required.">
                            <f:selectItem itemLabel="--- Select Department ---" itemValue="#{null}" noSelectionOption="true" />
                            <f:selectItems value="#{staffBean.availableDepartments}" var="deptItem"
                                           itemLabel="#{deptItem.displayName}" itemValue="#{deptItem}" />
                        </p:selectOneMenu>
                    </div>
                </div>
            </p:fieldset>

            <!-- ================== Action Buttons ================== -->
            <div class="button-bar mt-4">
                <p:commandButton value="Register" icon="pi pi-check" styleClass="ui-button-success"
                                 action="#{staffBean.register}" update="@form regMessages" process="@form" />

                <p:commandButton type="reset" value="Clear" icon="pi pi-refresh" styleClass="ui-button-secondary" />
            </div>
        </h:form>
    </p:card>
</ui:composition>
